theme(axis.title.y = element_text(size=20,face='bold'))
ggplot(data1,aes(x=기간))+geom_line(aes(y=수출.금액,color='수출',group=1), size = 1)+geom_line(aes(y=수입.금액,color='수입',group=1), size = 1)+
geom_point(aes(y=수출.금액,color='수출'), size = 3)+geom_point(aes(y=수입.금액,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=수출.금액,label=수출.금액),vjust=-1.5)+
geom_text(aes(y=수입.금액,label=수입.금액),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "데이터 유형"))+theme_bw()+labs(title="2014-2023년 육류 수출입현황                       단위 천달러",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
totaldata$연도 <- as.character(totaldata$연도)
str(totaldata)
ggplot(data1,aes(x=기간))+geom_line(aes(y=수출.금액,color='수출',group=1), size = 1)+geom_line(aes(y=수입.금액,color='수입',group=1), size = 1)+
geom_point(aes(y=수출.금액,color='수출'), size = 3)+geom_point(aes(y=수입.금액,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=수출.금액,label=수출.금액),vjust=-1.5)+
geom_text(aes(y=수입.금액,label=수입.금액),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 육류 수출입현황                       단위 천달러",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
ggplot(data1,aes(x=기간))+geom_line(aes(y=쇠.수,color='수출',group=1), size = 1)+geom_line(aes(y=쇠.입,color='수입',group=1), size = 1)+
geom_point(aes(y=쇠.수,color='수출'), size = 3)+geom_point(aes(y=쇠.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=쇠.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=쇠.입,label=쇠.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 쇠고기 수출입 물량현황                       단위 톤",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
totaldata
ggplot(data1,aes(x=기간))+geom_line(aes(y=쇠 수,color='수출',group=1), size = 1)+geom_line(aes(y=쇠 입,color='수입',group=1), size = 1)+
ggplot(totaldata,aes(x=기간))+geom_line(aes(y=쇠.수,color='수출',group=1), size = 1)+geom_line(aes(y=쇠.입,color='수입',group=1), size = 1)+
geom_point(aes(y=쇠.수,color='수출'), size = 3)+geom_point(aes(y=쇠.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=쇠.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=쇠.입,label=쇠.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 쇠고기 수출입 물량현황                       단위 톤",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=쇠.수,color='수출',group=1), size = 1)+geom_line(aes(y=쇠.입,color='수입',group=1), size = 1)+
geom_point(aes(y=쇠.수,color='수출'), size = 3)+geom_point(aes(y=쇠.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=쇠.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=쇠.입,label=쇠.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 쇠고기 수출입 물량현황                       단위 톤",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=쇠.수,color='수출',group=1), size = 1)+geom_line(aes(y=쇠.입,color='수입',group=1), size = 1)+
geom_point(aes(y=쇠.수,color='수출'), size = 3)+geom_point(aes(y=쇠.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=쇠.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=쇠.입,label=쇠.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 쇠고기 수출입 물량현황                       단위 톤",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous(limits = c(0, 500000))
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous((labels = scales::comma_format(scale = 1e-3), limits = c(0, 500000))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=쇠.수,color='수출',group=1), size = 1)+geom_line(aes(y=쇠.입,color='수입',group=1), size = 1)+
geom_point(aes(y=쇠.수,color='수출'), size = 3)+geom_point(aes(y=쇠.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=쇠.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=쇠.입,label=쇠.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 쇠고기 수출입 물량현황                       단위 톤",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous(labels = scales::comma_format(scale = 1e-3), limits = c(0, 500000))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=쇠.수,color='수출',group=1), size = 1)+geom_line(aes(y=쇠.입,color='수입',group=1), size = 1)+
geom_point(aes(y=쇠.수,color='수출'), size = 3)+geom_point(aes(y=쇠.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=쇠.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=쇠.입,label=쇠.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 쇠고기 수출입 물량현황                       단위 톤",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous(labels = scales::comma_format(scale = 1e-2), limits = c(0, 500000))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=쇠.수,color='수출',group=1), size = 1)+geom_line(aes(y=쇠.입,color='수입',group=1), size = 1)+
geom_point(aes(y=쇠.수,color='수출'), size = 3)+geom_point(aes(y=쇠.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=쇠.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=쇠.입,label=쇠.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 쇠고기 수출입 물량현황                       단위 톤",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous(labels = scales::comma_format(scale = 1e-4), limits = c(0, 500000))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=쇠.수,color='수출',group=1), size = 1)+geom_line(aes(y=쇠.입,color='수입',group=1), size = 1)+
geom_point(aes(y=쇠.수,color='수출'), size = 3)+geom_point(aes(y=쇠.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=쇠.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=쇠.입,label=쇠.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 쇠고기 수출입 물량현황                       단위 톤",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous(labels = scales::comma_format(scale = 1e-6), limits = c(0, 500000))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=쇠.수,color='수출',group=1), size = 1)+geom_line(aes(y=쇠.입,color='수입',group=1), size = 1)+
geom_point(aes(y=쇠.수,color='수출'), size = 3)+geom_point(aes(y=쇠.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=쇠.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=쇠.입,label=쇠.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 쇠고기 수출입 물량현황                       단위 톤",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous(labels = scales::comma_format(scale = 1e-4), limits = c(0, 500000))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=쇠.수,color='수출',group=1), size = 1)+geom_line(aes(y=쇠.입,color='수입',group=1), size = 1)+
geom_point(aes(y=쇠.수,color='수출'), size = 3)+geom_point(aes(y=쇠.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=쇠.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=쇠.입,label=쇠.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 쇠고기 수출입 물량현황                       단위 톤",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous(labels = scales::comma_format(scale = 1e-0), limits = c(0, 500000))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=쇠.수,color='수출',group=1), size = 1)+geom_line(aes(y=쇠.입,color='수입',group=1), size = 1)+
geom_point(aes(y=쇠.수,color='수출'), size = 3)+geom_point(aes(y=쇠.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=쇠.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=쇠.입,label=쇠.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 쇠고기 수출입 물량현황                       단위 톤",x ="연도", y = "물량")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous(labels = scales::comma_format(scale = 1e-0), limits = c(0, 500000))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=돼.수,color='수출',group=1), size = 1)+geom_line(aes(y=돼.입,color='수입',group=1), size = 1)+
geom_point(aes(y=돼.수,color='수출'), size = 3)+geom_point(aes(y=돼.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=돼.수,label=돼.수),vjust=-1.5)+
geom_text(aes(y=돼.입,label=돼.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 돼지고기 수출입 물량현황                       단위 톤",x ="연도", y = "물량")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous(labels = scales::comma_format(scale = 1e-0), limits = c(0, 500000))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=닭.수,color='수출',group=1), size = 1)+geom_line(aes(y=닭.입,color='수입',group=1), size = 1)+
geom_point(aes(y=닭.수,color='수출'), size = 3)+geom_point(aes(y=닭.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=닭.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=닭.입,label=닭.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 닭고기 수출입 물량현황                       단위 톤",x ="연도", y = "물량")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous(labels = scales::comma_format(scale = 1e-0), limits = c(0, 500000))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=닭.수,color='수출',group=1), size = 1)+geom_line(aes(y=닭.입,color='수입',group=1), size = 1)+
geom_point(aes(y=닭.수,color='수출'), size = 3)+geom_point(aes(y=닭.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=닭.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=닭.입,label=닭.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 닭고기 수출입 물량현황                       단위 톤",x ="연도", y = "물량")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous( limits = c(0, 200000))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=닭.수,color='수출',group=1), size = 1)+geom_line(aes(y=닭.입,color='수입',group=1), size = 1)+
geom_point(aes(y=닭.수,color='수출'), size = 3)+geom_point(aes(y=닭.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=닭.수,label=닭.수),vjust=-1.5)+
geom_text(aes(y=닭.입,label=닭.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 닭고기 수출입 물량현황                       단위 톤",x ="연도", y = "물량")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous( limits = c(0, 200000))
ggplot(data1,aes(x=기간))+geom_line(aes(y=수출.금액,color='수출',group=1), size = 1)+geom_line(aes(y=수입.금액,color='수입',group=1), size = 1)+
geom_point(aes(y=수출.금액,color='수출'), size = 3)+geom_point(aes(y=수입.금액,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=수출.금액,label=수출.금액),vjust=-1.5)+
geom_text(aes(y=수입.금액,label=수입.금액),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 육류 수출입현황                       단위 천달러",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
library(tidyverse)
library(dplyr)
library(stringr)
library(ggplot2)
library(tidytext)
reroll <- read.csv("리롤.csv")
소 <- reroll %>% filter(str_detect(reroll$품종,"소")==TRUE)
소$품종 <- gsub("소","",소$품종)
소$연도 <- as.character(소$연도)
소
소_min <- 소 %>% group_by(연도) %>% slice(which.min(판매량))
소_min
돼지 <- reroll %>% filter(str_detect(reroll$품종,"돼지")==TRUE)
돼지$품종 <- gsub("돼지","",돼지$품종)
돼지$연도 <- as.character(돼지$연도)
돼지
돼지_min <- 돼지 %>% group_by(연도) %>% slice(which.min(판매량))
돼지_min
닭 <- reroll %>% filter(str_detect(reroll$품종,"닭")==TRUE)
닭$품종 <- gsub("닭","",닭$품종)
닭$연도 <- as.character(닭$연도)
닭_min <-  닭%>% group_by(연도) %>% slice(which.min(판매량))
vjust_a <- ifelse(돼지$판매량%in% 돼지_min$판매량,1,-0.5)
vjust_b <- ifelse(닭$판매량%in% 닭_min$판매량,1.5,-0.5)
vjust_b
ggplot(소,aes(x=연도,y=판매량,fill=품종))+geom_bar(stat = 'identity',position = 'dodge',width = 0.8)+ scale_y_continuous(labels = scales::comma_format(scale = 1e-0),limits = c(0, 300000))+
geom_text(aes(label=판매량),position=position_dodge(width = 0.8),vjust=-0.5)+
theme_bw()+labs(title=paste0("2014-2023년 ","소", " 수입현황"),x ="연도", y = "수입량")+
theme(plot.title = element_text(hjust = 0.5,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
ggplot(돼지,aes(x=연도,y=판매량,fill=품종))+geom_bar(stat = 'identity',position = 'dodge',width = 0.8)+ scale_y_continuous(labels = scales::comma_format(scale = 1e-0),limits = c(0, 300000))+
geom_text(aes(label=판매량),position=position_dodge(width = 0.8),vjust=vjust_a)+
theme_bw()+labs(title=paste0("2014-2023년 ","돼지", " 수입현황"),x ="연도", y = "수입량")+
theme(plot.title = element_text(hjust = 0.55,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
ggplot(닭,aes(x=연도,y=판매량,fill=품종))+geom_bar(stat = 'identity',position = 'dodge',width = 0.8)+
geom_text(aes(label=판매량),position=position_dodge(width = 0.8),vjust=vjust_b)+theme_bw()+labs(title=paste0("2014-2023년 ","닭", " 수입현황"),x ="연도", y = "수입량")+
theme(plot.title = element_text(hjust = 0.55,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
data2 <- read.csv("33.csv")
data2
data2$연도 <- as.character(data2$연도)
str(data2)
ggplot(data1,aes(x=기간))+geom_bar(aes(y=무역수지),stat ='identity',alpha=0.2,fill=ifelse(data1$무역수지<0,'blue','red'),width = 0.55,position = "identity")+geom_line(aes(y=수출.금액,color='수출',group=1), size = 1)+geom_line(aes(y=수입.금액,color='수입',group=1), size = 1)+
geom_point(aes(y=수출.금액,color='수출'), size = 3)+geom_point(aes(y=수입.금액,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=수출.금액,label=수출.금액),vjust=ifelse(data1$무역수지<0,2,-1.7))+
geom_text(aes(y=무역수지,label=무역수지),vjust = -0.5,color=ifelse(data1$무역수지<0,'blue','red'))+
geom_text(aes(y=수입.금액,label=수입.금액),vjust=ifelse(data1$무역수지<0,-1.5,1.5))+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 육류 수출입현황                       단위 천달러",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
library(tidyverse)
library(dplyr)
library(stringr)
library(ggplot2)
library(tidytext)
ggplot(data1,aes(x=기간))+geom_bar(aes(y=무역수지),stat ='identity',alpha=0.2,fill=ifelse(data1$무역수지<0,'blue','red'),width = 0.55,position = "identity")+geom_line(aes(y=수출.금액,color='수출',group=1), size = 1)+geom_line(aes(y=수입.금액,color='수입',group=1), size = 1)+
geom_point(aes(y=수출.금액,color='수출'), size = 3)+geom_point(aes(y=수입.금액,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=수출.금액,label=수출.금액),vjust=ifelse(data1$무역수지<0,2,-1.7))+
geom_text(aes(y=무역수지,label=무역수지),vjust = -0.5,color=ifelse(data1$무역수지<0,'blue','red'))+
geom_text(aes(y=수입.금액,label=수입.금액),vjust=ifelse(data1$무역수지<0,-1.5,1.5))+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 육류 수출입현황                       단위 천달러",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
reroll <- read.csv("리롤.csv")
소 <- reroll %>% filter(str_detect(reroll$품종,"소")==TRUE)
소$품종 <- gsub("소","",소$품종)
소$연도 <- as.character(소$연도)
소
소_min <- 소 %>% group_by(연도) %>% slice(which.min(판매량))
소_min
돼지 <- reroll %>% filter(str_detect(reroll$품종,"돼지")==TRUE)
돼지$품종 <- gsub("돼지","",돼지$품종)
돼지$연도 <- as.character(돼지$연도)
돼지
돼지_min <- 돼지 %>% group_by(연도) %>% slice(which.min(판매량))
돼지_min
닭 <- reroll %>% filter(str_detect(reroll$품종,"닭")==TRUE)
닭$품종 <- gsub("닭","",닭$품종)
닭$연도 <- as.character(닭$연도)
닭_min <-  닭%>% group_by(연도) %>% slice(which.min(판매량))
vjust_a <- ifelse(돼지$판매량%in% 돼지_min$판매량,1,-0.5)
vjust_b <- ifelse(닭$판매량%in% 닭_min$판매량,1.5,-0.5)
vjust_b
ggplot(소,aes(x=연도,y=판매량,fill=품종))+geom_bar(stat = 'identity',position = 'dodge',width = 0.8)+ scale_y_continuous(labels = scales::comma_format(scale = 1e-0),limits = c(0, 300000))+
geom_text(aes(label=판매량),position=position_dodge(width = 0.8),vjust=-0.5)+
theme_bw()+labs(title=paste0("2014-2023년 ","소", " 수입현황"),x ="연도", y = "수입량")+
theme(plot.title = element_text(hjust = 0.5,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
ggplot(돼지,aes(x=연도,y=판매량,fill=품종))+geom_bar(stat = 'identity',position = 'dodge',width = 0.8)+ scale_y_continuous(labels = scales::comma_format(scale = 1e-0),limits = c(0, 300000))+
geom_text(aes(label=판매량),position=position_dodge(width = 0.8),vjust=vjust_a)+
theme_bw()+labs(title=paste0("2014-2023년 ","돼지", " 수입현황"),x ="연도", y = "수입량")+
theme(plot.title = element_text(hjust = 0.55,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
ggplot(닭,aes(x=연도,y=판매량,fill=품종))+geom_bar(stat = 'identity',position = 'dodge',width = 0.8)+
geom_text(aes(label=판매량),position=position_dodge(width = 0.8),vjust=vjust_b)+theme_bw()+labs(title=paste0("2014-2023년 ","닭", " 수입현황"),x ="연도", y = "수입량")+
theme(plot.title = element_text(hjust = 0.55,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
data1 <- read.csv("111.csv")
data1
data1$기간 <- as.character(data1$기간)
str(data1)
ggplot(data1,aes(x=기간))+geom_bar(aes(y=무역수지),stat ='identity',alpha=0.2,fill=ifelse(data1$무역수지<0,'blue','red'),width = 0.55,position = "identity")+geom_line(aes(y=수출.금액,color='수출',group=1), size = 1)+geom_line(aes(y=수입.금액,color='수입',group=1), size = 1)+
geom_point(aes(y=수출.금액,color='수출'), size = 3)+geom_point(aes(y=수입.금액,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=수출.금액,label=수출.금액),vjust=ifelse(data1$무역수지<0,2,-1.7))+
geom_text(aes(y=무역수지,label=무역수지),vjust = -0.5,color=ifelse(data1$무역수지<0,'blue','red'))+
geom_text(aes(y=수입.금액,label=수입.금액),vjust=ifelse(data1$무역수지<0,-1.5,1.5))+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 육류 수출입현황                       단위 천달러",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=닭.수,color='수출',group=1), size = 1)+geom_line(aes(y=닭.입,color='수입',group=1), size = 1)+
geom_point(aes(y=닭.수,color='수출'), size = 3)+geom_point(aes(y=닭.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=닭.수,label=닭.수),vjust=-1.5)+
geom_text(aes(y=닭.입,label=닭.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 닭고기 수출입 물량현황                       단위 톤",x ="연도", y = "물량")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous( limits = c(0, 200000))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=돼.수,color='수출',group=1), size = 1)+geom_line(aes(y=돼.입,color='수입',group=1), size = 1)+
geom_point(aes(y=돼.수,color='수출'), size = 3)+geom_point(aes(y=돼.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=돼.수,label=돼.수),vjust=-1.5)+
geom_text(aes(y=돼.입,label=돼.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 돼지고기 수출입 물량현황                       단위 톤",x ="연도", y = "물량")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous(labels = scales::comma_format(scale = 1e-0), limits = c(0, 500000))
ggplot(totaldata,aes(x=연도))+geom_line(aes(y=쇠.수,color='수출',group=1), size = 1)+geom_line(aes(y=쇠.입,color='수입',group=1), size = 1)+
geom_point(aes(y=쇠.수,color='수출'), size = 3)+geom_point(aes(y=쇠.입,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=쇠.수,label=쇠.수),vjust=-1.5)+
geom_text(aes(y=쇠.입,label=쇠.입),vjust=-1.5)+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 쇠고기 수출입 물량현황                       단위 톤",x ="연도", y = "물량")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))+ scale_y_continuous(labels = scales::comma_format(scale = 1e-0), limits = c(0, 500000))
ggplot(data1,aes(x=기간))+geom_bar(aes(y=무역수지),stat ='identity',alpha=0.2,fill=ifelse(data1$무역수지<0,'blue','red'),width = 0.55,position = "identity")+geom_line(aes(y=수출.금액,color='수출',group=1), size = 1)+geom_line(aes(y=수입.금액,color='수입',group=1), size = 1)+
geom_point(aes(y=수출.금액,color='수출'), size = 3)+geom_point(aes(y=수입.금액,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=수출.금액,label=수출.금액),vjust=ifelse(data1$무역수지<0,2,-1.7))+
geom_text(aes(y=무역수지,label=무역수지),vjust = -0.5,color=ifelse(data1$무역수지<0,'blue','red'))+
geom_text(aes(y=수입.금액,label=수입.금액),vjust=ifelse(data1$무역수지<0,-1.5,1.5))+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 육류 수출입현황                       단위 천달러",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
ggplot(data,aes(x=기간))+geom_line(aes(y=수출.금액),color='red', size = 1)+geom_line(aes(y=수입.금액),color='blue', size = 1)+
geom_point(aes(y=수출.금액),color='red', size = 3)+geom_point(aes(y=수입.금액),color='blue', size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=수출.금액,label=수출.금액),vjust=-2)+
geom_text(aes(y=수입.금액,label=수입.금액),vjust=-2)+labs(title="2014-2023년 육류 수출입현황",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.5,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
labs(color = "수출입")
ggplot(data1,aes(x=기간))+geom_bar(aes(y=무역수지),stat ='identity',alpha=0.2,fill=ifelse(data1$무역수지<0,'blue','red'),width = 0.55,position = "identity")+geom_line(aes(y=수출.금액,color='수출',group=1), size = 1)+geom_line(aes(y=수입.금액,color='수입',group=1), size = 1)+
geom_point(aes(y=수출.금액,color='수출'), size = 3)+geom_point(aes(y=수입.금액,color='수입'), size = 3)+
xlab("기간")+ylab("금액")+geom_text(aes(y=수출.금액,label=수출.금액),vjust=ifelse(data1$무역수지<0,2,-1.7))+
geom_text(aes(y=무역수지,label=무역수지),vjust = -0.5,color=ifelse(data1$무역수지<0,'blue','red'))+
geom_text(aes(y=수입.금액,label=수입.금액),vjust=ifelse(data1$무역수지<0,-1.5,1.5))+
scale_color_manual(values=c("수출"='#F78181',"수입"="#8181F7")) + labs(color="Type") +
guides(color=guide_legend(title= "수출입구분"))+theme_bw()+labs(title="2014-2023년 육류 수출입현황                       단위 천달러",x ="연도", y = "금액")+
theme(plot.title = element_text(hjust = 0.75,size=20,face='bold'))+theme(axis.title.x = element_text(size=20,face='bold'))+
theme(axis.title.y = element_text(size=20,face='bold'))
library(shiny)
library(quantmod)
library(dygraphs)
library(highcharter)
library(tidyverse)
library(dplyr)
library(stringr)
library(ggplot2)
library(tidytext)
library(ggwordcloud)
library(showtext)
library(KoNLP)
library(multilinguer)
library(readr)
library(httr)
library(textclean)
library(RCurl)
library(rvest)
library(xts)
library(lubridate)
library(timetk)
library(tidygraph)
library(widyr)
library(ggraph)
library(magrittr)
library(PerformanceAnalytics)
library(corrplot)
library(forecast)
library(TTR)
library(tm)
library(xml2)
n5 <- read.csv("5번.csv")
setwd("C:/Users/MSI/Desktop/논문 데이터/서론")
n5 <- read.csv("5번.csv")
n4 <- read.csv("4번.csv")
steel <- rbind(n4,n5)
n5 <- read.csv("5번.csv")
n4 <- read.csv("4번.csv")
steel <- rbind(n4,n5)
n5 <- read.csv("5번.csv")
n4 <- read.csv("4번.csv")
steel <- rbind(n4,n5)
steel <- na.omit(steel)
steel <- na.omit(steel)
steel <- steel[,c(1,2,5,6,7,8,9)]
View(steel)
steel <- steel %>% group_by(기간) %>% summarise(수출합=sum(수출중량))
steel <- steel %>% group_by(기간) %>% summarise(수입합=sum(수입중량))
n5 <- read.csv("5번.csv")
n4 <- read.csv("4번.csv")
steel <- rbind(n4,n5)
steel <- na.omit(steel)
steel <- steel[,c(1,2,5,6,7,8,9)]
steel <- steel %>% group_by(기간) %>% summarise(수입합=sum(수입중량))
View(steel)
View(steel)
n5 <- read.csv("5번.csv")
n4 <- read.csv("4번.csv")
steel <- rbind(n4,n5)
steel <- na.omit(steel)
steel <- steel[,c(1,2,5,6,7,8,9)]
steel_t <- steel %>% group_by(기간) %>% summarise(수입합=sum(수입중량))
View(steel)
steel <- steel[steel$국가=="중국",]
View(steel)
View(steel_t)
View(steel)
View(steel_t)
View(steel)
View(steel_t)
steel <- merge(steel,steel_t)
steel
steel <- mutate(steel,비중=수입중량/수입합)
steel
steel <- mutate(steel,비중=round(수입중량/수입합*100))
steel
steel <- mutate(steel,비중=round(수입중량/수입합*100,1))
steel
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량),stat='identity')
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.0001),stat='identity')
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.0001),stat='identity')+geom_line(aes(y=비중))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.0001),stat='identity')+geom_line(aes(y=비중,group=1))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.0001),stat='identity')+geom_line(aes(y=비중*1000,group=1))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.0001),stat='identity')+geom_line(aes(y=비중*10,group=1))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.0001),stat='identity')+geom_line(aes(y=비중*100,group=1))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.0001),stat='identity')+geom_line(aes(y=비중*50,group=1))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.0001),stat='identity')+geom_line(aes(y=비중*40,group=1))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.0001),stat='identity')+geom_line(aes(y=비중*30,group=1))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.0001),stat='identity')+geom_line(aes(y=비중*30,group=1))+geom_point(aes(y=비중*30,group=1))
geom_text(aes(y=수입중량,label=round(수입중량*0.0001))
geom_text(aes(y=수입중량*0.0001,label=round(수입중량*0.0001))
geom_text(aes(y=수입중량,label=round(수입중량*0.0001))
geom_text(aes(label=round(수입중량*0.0001))
ggplot(steel,aes(x=기간,y=수출중량,fill=국가))+geom_bar(stat='identity')+scale_fill_brewer(palette = "OrRd")+
geom_text(label=round(steel$수출중량*0.001,1),position = position_stack(vjust=0.5),size=4)+labs(y=NULL,title=NULL)+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.position = "bottom")
geom_text(aes(label=round(수입중량*0.0001))
geom_text(aes(label=round(수입중량*0.0001))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.0001),stat='identity')+geom_line(aes(y=비중*30,group=1))+geom_point(aes(y=비중*30,group=1))+
geom_text(aes(label=round(수입중량*0.0001)))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.0001),stat='identity')+geom_line(aes(y=비중*30,group=1))+geom_point(aes(y=비중*30,group=1))+
geom_text(aes(y=수입중량,label=round(수입중량*0.0001)))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.0001),stat='identity')+geom_line(aes(y=비중*30,group=1))+geom_point(aes(y=비중*30,group=1))+
geom_text(aes(y=수입중량*0.0001,label=round(수입중량*0.0001)))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*30,group=1))+geom_point(aes(y=비중*30,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=0.5)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=0.5)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=-1.5)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=1.5)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=aes(y=비중*300)))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=y=비중*300))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=y=비중*300))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중*300))
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중*300),vjust=-1.5)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.5)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.4)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1))+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1))+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),fill='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity')+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',color='orange')+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange')+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange')+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange')+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)+labs(y=NULL)+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange')+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)+labs(y=수입중량)+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange')+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)+labs(y="수입중량")+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange')+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)+labs(y="수입중량")+ scale_y_continuous(sec.axis = sec_axis(~.*10, name = "var2"))+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange')+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)+labs(y="수입중량")+ scale_y_continuous(sec.axis = sec_axis(~.*10, name = "수입 비중 "))+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange')+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)+labs(y="수입중량")+ scale_y_continuous(sec.axis = sec_axis(~.*10, name = "수입 비중(%) "))+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange',width=3)+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)+labs(y="수입중량")+ scale_y_continuous(sec.axis = sec_axis(~.*10, name = "수입 비중(%) "))+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange',width=1)+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)+labs(y="수입중량")+ scale_y_continuous(sec.axis = sec_axis(~.*10, name = "수입 비중(%) "))+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange',width=0.2)+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)+labs(y="수입중량")+ scale_y_continuous(sec.axis = sec_axis(~.*10, name = "수입 비중(%) "))+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange',width=0.6)+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)+labs(y="수입중량")+ scale_y_continuous(sec.axis = sec_axis(~.*10, name = "수입 비중(%) "))+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange',width=0.8)+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.3)+labs(y="수입중량")+ scale_y_continuous(sec.axis = sec_axis(~.*10, name = "수입 비중(%) "))+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange',width=0.8)+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1.2)+labs(y="수입중량")+ scale_y_continuous(sec.axis = sec_axis(~.*10, name = "수입 비중(%) "))+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
ggplot(steel,aes(x=기간))+geom_bar(aes(y=수입중량*0.001),stat='identity',fill='orange',width=0.8)+geom_line(aes(y=비중*300,group=1),color='red')+geom_point(aes(y=비중*300,group=1),color='red')+
geom_text(aes(y=수입중량*0.001,label=round(수입중량*0.001)),vjust=5)+geom_text(aes(y=비중*300,label=비중),vjust=-1)+labs(y="수입중량")+ scale_y_continuous(sec.axis = sec_axis(~.*10, name = "수입 비중(%) "))+
theme_minimal()+
theme(axis.line=element_blank(),axis.text.y = element_blank(),axis.ticks = element_blank(),legend.title = element_blank(),legend.position = "bottom")
